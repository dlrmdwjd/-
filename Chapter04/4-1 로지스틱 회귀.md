# 4-1. 로지스틱 회귀

### 🪵 로지스틱 회귀 (logistic regression)

분류 모델. 선형 회귀와 동일하게 선형 방정식을 학습한다. 

선형 방정식을 사용한 분류 알고리즘.

선형 회귀와 달리 시그모이드 함수나 소프트맥스 함수를 사용하여 클래스 확률을 출력할 수 있다. 

**다중 분류 (multi-class classification)**

타깃 데이터에 2개 이상의 클래스가 포함된 문제. 

로지스틱 회귀는 다중 분류를 위해 소프트맥스 함수를 사용하여 클래스를 예측한다.

**시그모이드(sigmoid) 함수 / 로지스틱(logistic) 함수**

선형 방정식의 출력을 0과 1 사이의 값으로 압축하여 이진 분류를 위해 사용한다. 

![image.png](4-1%20%E1%84%85%E1%85%A9%E1%84%8C%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%A8%20%E1%84%92%E1%85%AC%E1%84%80%E1%85%B1%20f3082a6ba1aa4602929fa3ac000554c0/image.png)

**소프트맥스 함수**

다중 분류에서 여러 선형 방정식의 출력 결과를 정규화하여 합이 1이 되도록 만든다. 

지수 함수를 사용하기 때문에 정규화된 지수 함수라고도 부른다. 

![image.png](4-1%20%E1%84%85%E1%85%A9%E1%84%8C%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%A8%20%E1%84%92%E1%85%AC%E1%84%80%E1%85%B1%20f3082a6ba1aa4602929fa3ac000554c0/image%201.png)

**L2 규제**

로지스틱 회귀에서 사용되는 규제로, 릿지 회귀와 같이 계수의 제곱을 규제한다. 

### 👩‍💻 scikit-learn

**LogisticRegression**

선형 분류 알고리즘인 로지스틱 회귀를 위한 클래스

- `solver` : 사용할 알고리즘 선택 (기본값 : `lbfgs`)
    - `sag` : 확률적 평균 경사 하강법 알고리즘
    - `saga` : sag의 개선 버전
- `penalty` : L2 규제(릿지 방식)와 L1 규제(라쏘 방식)를 선택할 수 있다. (기본값 : `l2`)
- `C` : 규제의 강도를 제어, 작을수록 규제가 강해진다. (기본값 : 1.0)
- `predict_proba()` : 예측 확률을 반환
    - 이진 분류의 경우 샘플마다 음성 클래스와 양성 클래스에 대한 확률을 반환
    - 다중 뷴류의 경우 샘플마다 모든 클래스에 대한 확률을 반환
- `decision_function()` : 모델이 학습한 선형 방정식의 출력을 반환
    - 이진 분류의 경우 양성 클래스의 확률을 반환 (이 값이 0보다 크면 양성 클래스, 작거나 같으면 음성 클래스로 예측)
    - 다중 분류의 경우 각 클래스마다 선형 방정식을 계산 (가장 큰 값의 클래스가 예측 클래스)

- **➕ 로지스틱 회귀**
    
    
    1. **로지스틱 회귀**
    
    분류 기법에서 주로 사용되는 모델.
    
    종속 변수가 두 개의 클래스를 갖는 범주형일 때 분류 기법으로 사용한다.
    
    분류를 하는 데 있어서 확률값을 사용.
    
    예를 들어, 50% 이상의 확률값을 가지면 클래스 1, 아니면 클래스 0의 방식으로 분류를 진행한다. 
    
    즉, 0과 1을 예측하는 것이 아니라 [0, 1] 사이에 들어갈 확률값을 예측하는 것. 
    
    [0, 1] 사이의 값을 갖게 하기 위해서 시그모이드 함수(= 로지스틱 함수)를 사용. 이 확률값을 기준으로 이진 분류를 수행.
    
    [로지스틱 회귀계수 추정]
    
    - 최대우도법 (MLE)
    - Gradient Descent Method
    
    1. **다중 로지스틱 회귀**
    
    3개 이상의 클래스 중 하나의 클래스에 속하는지를 예측하는 문제.
    
    여러 가지 클래스 중 예측 모델이 속할 확률이 가장 높은 클래스를 찾는 문제.
    
    다중 분류의 예측은 클래스의 개수만큼 예측 결과가 필요하다. 
    
    이러한 다중 문류를 위해 다중 로지스틱 회귀 모델에서는 일반적으로 Softmax 함수를 사용한다. 
    
    ** Softmax 함수 : K개의 클래스가 있는 다중 분류 문제에서 j번째 softmax 함수 결과는 아래와 같이 나타난다. 
    
    ![image.png](4-1%20%E1%84%85%E1%85%A9%E1%84%8C%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%A8%20%E1%84%92%E1%85%AC%E1%84%80%E1%85%B1%20f3082a6ba1aa4602929fa3ac000554c0/image%202.png)
    
    [학습 방법]
    
    최대우도방법(MLE, Maximum Likelihood Estimation)을 사용
    
    학습에 사용되는 정답을 One-hot vector 형색으로 나타내야 한다.
    
    참고자료 :
    
    [1] https://m.blog.naver.com/winddori2002/221706766540
    
    [2] https://devhwi.tistory.com/19
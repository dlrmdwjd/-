# 2024 08 28 수요일 -2

## 로지스틱 회귀

로지스틱 회귀 : 이름은 회귀이지만 분류 모델.. 선형 회귀와 동일하게 선형 방정식을 학습.

확률을 표현하기 위해 0~1 사이의 값을 가져야함. 따라서 시그모이드 함수를 이용!

![sigmoid.bfc853980146c5868a496eafea4fb79907675f44.png](2024%2008%2028%20%E1%84%89%E1%85%AE%E1%84%8B%E1%85%AD%E1%84%8B%E1%85%B5%E1%86%AF%20-2%205188ca7051844dd187b22f4edcc81ffa/sigmoid.bfc853980146c5868a496eafea4fb79907675f44.png)

![S-curve.36de3c694cafe97ef4e391ed26a5cb0b357f6316.png](2024%2008%2028%20%E1%84%89%E1%85%AE%E1%84%8B%E1%85%AD%E1%84%8B%E1%85%B5%E1%86%AF%20-2%205188ca7051844dd187b22f4edcc81ffa/S-curve.36de3c694cafe97ef4e391ed26a5cb0b357f6316.png)

### 로지스틱 회귀로 분류 수행하기

불리언 인덱싱 : True, False 값을 전달하여 행을 선택

이진 분류에서는 시그모이드를 활용하여 선형 방정식의 출력값을 0-1 사이의 확률 값으로 압축할 수 있었다면 다중 분류에서는 소프트맥스 함수를 이용하여 0-1사이의 값으로 압축하고 전체 계수의 합이 1이 되도록 함. 

### 로지스틱 회귀

로지스틱 회귀에는 책에서 소개한 (1) 이항 로지스틱 회귀, (2) 다항 로지스틱 회귀 그리고 책에서 소개하지 않은 (3) 서수 로지스틱 회귀가 있습니다!

서수 로지스틱 회귀의 경우 숫자가 실제 의미를 가진 것이 아닌 ‘순위’를 의미할 때 사용합니다.

ex) 우수, 보통, 나쁨 등

**로지스틱 회귀의 비용 함수:**

로지스틱 회귀 역시 경사 하강법을 이용하여 가중치를 찾지만 비용 함수로는 MSE를 사용하지 않음!

(극솟값을 이용하게 되는 경우가 생길 수 있으므로)

![로지스틱회귀1.JPG](2024%2008%2028%20%E1%84%89%E1%85%AE%E1%84%8B%E1%85%AD%E1%84%8B%E1%85%B5%E1%86%AF%20-2%205188ca7051844dd187b22f4edcc81ffa/%25E1%2584%2585%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25B5%25E1%2584%2589%25E1%2585%25B3%25E1%2584%2590%25E1%2585%25B5%25E1%2586%25A8%25E1%2584%2592%25E1%2585%25AC%25E1%2584%2580%25E1%2585%25B11.jpg)

로지스틱 회귀에서는 비용함수로 **크로스 엔트로피** 함수를 사용

$$
J(w) = \frac{1}{n} \sum_{i=1}^{n} cost\left(H(x^{(i)}), y^{(i)})\right)
$$

다음 함수를 목적함수 (가중치를 최소화하는 함수!) 라고 해봅시다. 시그모이드 함수는 0과 1 사이의 y값을 리턴하므로 실제 값이 0인 경우에 y값이 1에 가까워진다면 오차가 커지고 실제 값이 1인 경우에 y값이 0에 가까워진다면 오차가 커지는 케이스입니다.

그래서 아래와 같이 서로 다른 케이스의 로그 함수를 이용합니당

$$
\text{if } y=1 → \text{cost}\left( H(x), y \right) = -\log(H(x))
$$

$$
\text{if } y=0 → \text{cost}\left( H(x), y \right) = -\log(1-H(x))
$$

그 때 그래프는 아래와 같은데요 : 

![로지스틱회귀2.JPG](2024%2008%2028%20%E1%84%89%E1%85%AE%E1%84%8B%E1%85%AD%E1%84%8B%E1%85%B5%E1%86%AF%20-2%205188ca7051844dd187b22f4edcc81ffa/%25E1%2584%2585%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25B5%25E1%2584%2589%25E1%2585%25B3%25E1%2584%2590%25E1%2585%25B5%25E1%2586%25A8%25E1%2584%2592%25E1%2585%25AC%25E1%2584%2580%25E1%2585%25B12.jpg)

이러한 그래프의 경우 다음과 같은 식으로 다시 표시할 수 있습니다! :

$$
\text{cost}\left( H(x), y \right) = -[ylogH(x) + (1-y)log(1-H(x))]
$$

그래서 크로스 엔트로피 비용 함수는 결론적으로 다음과 같이 표현합니다 :

$$
J(w) = -\frac{1}{n} \sum_{i=1}^{n} [y^{(i)}logH(x^{(i)}) + (1-y^{(i)})log(1-H(x^{(i)}))]
$$
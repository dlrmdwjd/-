# 5-2. κµμ°¨ κ²€μ¦κ³Ό κ·Έλ¦¬λ“ μ„μΉ

### π’Β κ²€μ¦ μ„ΈνΈ (validation set)

ν•μ΄νΌνλΌλ―Έν„° νλ‹μ„ μ„ν•΄ λ¨λΈμ„ ν‰κ°€ν•  λ•, ν…μ¤νΈ μ„ΈνΈλ¥Ό μ‚¬μ©ν•μ§€ μ•κΈ° μ„ν•΄ ν›λ ¨ μ„ΈνΈμ—μ„ λ‹¤μ‹ λ–Όμ–΄ λ‚Έ λ°μ΄ν„° μ„ΈνΈ

β“ν…μ¤νΈ/κ²€μ¦ μ„ΈνΈμ— μ–Όλ§λ‚ λ§μ€ μƒν”μ„ λμ–΄λ†”μ•Ό ν• κΉ?

λ³΄ν†µ 20 ~ 30%λ¥Ό ν…μ¤νΈ μ„ΈνΈμ™€ κ²€μ¦ μ„ΈνΈλ΅ λ–Όμ–΄ λ†“λ”λ‹¤. ν›λ ¨ λ°μ΄ν„°κ°€ μ•„μ£Ό λ§λ‹¤λ©΄ λ‹¨ λ‡ %λ§ λ–Όμ–΄ λ†“μ•„λ„ μ „μ²΄ λ°μ΄ν„°λ¥Ό λ€ν‘ν•λ” λ° λ¬Έμ κ°€ μ—†λ‹¤. 

ν›λ ¨μ„ΈνΈμ—μ„ λ¨λΈ ν›λ ¨ β†’ κ²€μ¦ μ„ΈνΈλ΅ λ¨λΈ ν‰κ°€ β†’ λ§¤κ°λ³€μ λ°”κΏ”κ°€λ©° κ°€μ¥ μΆ‹μ€ λ¨λΈ μ„ νƒ 

β†’ μ΄ λ§¤κ°λ³€μλ¥Ό μ‚¬μ©ν•΄ ν›λ ¨ μ„ΈνΈμ™€ κ²€μ¦ μ„ΈνΈλ¥Ό ν•©μ³ μ „μ²΄ ν›λ ¨ λ°μ΄ν„°μ—μ„ λ¨λΈμ„ λ‹¤μ‹ ν›λ ¨ 

β†’ λ§μ§€λ§‰μΌλ΅ ν…μ¤νΈ μ„ΈνΈμ—μ„ μµμΆ… μ μλ¥Ό ν‰κ°€

### β”οΈΒ κµμ°¨ κ²€μ¦ (cross validation)

ν›λ ¨ μ„ΈνΈλ¥Ό μ—¬λ¬ ν΄λ“λ΅ λ‚λ λ‹¤μ ν• ν΄λ“κ°€ κ²€μ¦ μ„ΈνΈμ μ—­ν• μ„ ν•κ³  λ‚λ¨Έμ§€ ν΄λ“μ—μ„λ” λ¨λΈμ„ ν›λ ¨ν•λ‹¤. κµμ°¨ κ²€μ¦μ€ μ΄λ° μ‹μΌλ΅ λ¨λ“  ν΄λ“μ— λ€ν•΄ κ²€μ¦ μ μλ¥Ό μ–»μ–΄ ν‰κ· ν•λ” λ°©λ²•μ΄λ‹¤. 

κµμ°¨ κ²€μ¦μ„ μ΄μ©ν•λ©΄ μ•μ •μ μΈ κ²€μ¦ μ μλ¥Ό μ–»κ³  ν›λ ¨μ— λ” λ§μ€ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•  μ μλ‹¤. 

**3-ν΄λ“ κµμ°¨ κ²€μ¦**

ν›λ ¨ μ„ΈνΈλ¥Ό μ„Έ λ¶€λ¶„μΌλ΅ λ‚λ μ„ κµμ°¨ κ²€μ¦μ„ μν–‰ν•λ” κ²ƒ. ν†µμΉ­ **k-ν΄λ“ κµμ°¨ κ²€μ¦(k-fold cross validation)**μ΄λΌκ³  ν•λ©°, ν›λ ¨ μ„ΈνΈλ¥Ό λ‡ λ¶€λ¶„μΌλ΅ λ‚λ„λƒμ— λ”°λΌ λ‹¤λ¥΄κ² λ¶€λ¥Έλ‹¤. k-κ²Ή κµμ°¨ κ²€μ¦μ΄λΌκ³ λ„ λ¶€λ¥Έλ‹¤. 

### πµβ€π’«Β ν•μ΄νΌνλΌλ―Έν„° νλ‹

ν•μ΄νΌνλΌλ―Έν„° : λ¨λΈμ΄ ν•™μµν•  μ μ—†μ–΄μ„ μ‚¬μ©μκ°€ μ§€μ •ν•΄μ•Όλ§ ν•λ” νλΌλ―Έν„°

[ν•μ΄νΌνλΌλ―Έν„° νλ‹]

1. λ¨Όμ € λΌμ΄λΈλ¬λ¦¬κ°€ μ κ³µν•λ” κΈ°λ³Έκ°’μ„ κ·Έλ€λ΅ μ‚¬μ©
2. κ²€μ¦ μ„ΈνΈμ μ μλ‚ κµμ°¨ κ²€μ¦μ„ ν†µν•΄μ„ λ§¤κ°λ³€μλ¥Ό μ΅°κΈμ”© λ³€κ²½
3. λ§¤κ°λ³€μλ¥Ό λ°”κΏ”κ°€λ©΄μ„ λ¨λΈμ„ ν›λ ¨ν•κ³  κµμ°¨ κ²€μ¦μ„ μν–‰

** μ—¬λ¬ κ°μ λ§¤κ°λ³€μλ¥Ό λ™μ‹μ— λ°”κΏ”κ°€λ©° μµμ μ κ°’μ„ μ°Ύμ•„μ•Ό ν•λ‹¤! ν• λ§¤κ°λ³€μμ μµμ κ°’μ€ λ‹¤λ¥Έ λ§¤κ°λ³€μ κ°’μ΄ λ°”λ€λ©΄ ν•¨κ» λ‹¬λΌμ§€κΈ° λ•λ¬Έ.

**κ·Έλ¦¬λ“ μ„μΉ (Grid Search)**

ν•μ΄νΌνλΌλ―Έν„° νƒμƒ‰κ³Ό κµμ°¨ κ²€μ¦μ„ ν• λ²μ— μν–‰. 

ν•μ΄νΌνλΌλ―Έν„° νƒμƒ‰μ„ μλ™ν™”ν•΄ μ£Όλ” λ„κµ¬. νƒμƒ‰ν•  λ§¤κ°λ³€μλ¥Ό λ‚μ—΄ν•λ©΄ κµμ°¨ κ²€μ¦μ„ μν–‰ν•μ—¬ κ°€μ¥ μΆ‹μ€ κ²€μ¦ μ μμ λ§¤κ°λ³€μ μ΅°ν•©μ„ μ„ νƒν•λ‹¤. λ§μ§€λ§‰μΌλ΅ μ΄ λ§¤κ°λ³€μ μ΅°ν•©μΌλ΅ μµμΆ… λ¨λΈμ„ ν›λ ¨ν•λ‹¤. 

1. λ¨Όμ € νƒμƒ‰ν•  λ§¤κ°λ³€μλ¥Ό μ§€μ •ν•λ‹¤.
2. κ·Έλ‹¤μ ν›λ ¨ μ„ΈνΈμ—μ„ κ·Έλ¦¬λ“ μ„μΉλ¥Ό μν–‰ν•μ—¬ μµμƒμ ν‰κ·  κ²€μ¦ μ μκ°€ λ‚μ¤λ” λ§¤κ°λ³€μ μ΅°ν•©μ„ μ°Ύλ”λ‹¤. μ΄ μ΅°ν•©μ€ κ·Έλ¦¬λ“ μ„μΉ κ°μ²΄μ— μ €μ¥λλ‹¤.
3. κ·Έλ¦¬λ“ μ„μΉλ” μµμƒμ λ§¤κ°λ³€μμ—μ„ (κµμ°¨ κ²€μ¦μ— μ‚¬μ©ν• ν›λ ¨ μ„ΈνΈκ°€ μ•„λ‹λΌ) μ „μ²΄ ν›λ ¨ μ„ΈνΈλ¥Ό μ‚¬μ©ν•΄ μµμΆ… λ¨λΈμ„ ν›λ ¨ν•λ‹¤. μ΄ λ¨λΈλ„ κ·Έλ¦¬λ“ μ„μΉ κ°μ²΄μ— μ €μ¥λλ‹¤. 

**λλ¤ μ„μΉ (Random Search)**

μ—°μ†λ λ§¤κ°λ³€μ κ°’μ„ νƒμƒ‰ν•  λ• μ μ©ν•λ‹¤. νƒμƒ‰ν•  κ°’μ„ μ§μ ‘ λ‚μ—΄ν•λ” κ²ƒμ΄ μ•„λ‹κ³  νƒμƒ‰ κ°’μ„ μƒν”λ§ν•  μ μλ” ν™•λ¥  λ¶„ν¬ κ°μ²΄λ¥Ό μ „λ‹¬ν•λ‹¤. μ§€μ •λ νμλ§νΌ μƒν”λ§ν•μ—¬ κµμ°¨ κ²€μ¦μ„ μν–‰ν•κΈ° λ•λ¬Έμ— μ‹μ¤ν… μμ›μ΄ ν—λ½ν•λ” λ§νΌ νƒμƒ‰λ‰μ„ μ΅°μ ν•  μ μλ‹¤. 

### π‘©β€π’»Β scikit-learn

- `cross_validate()` : κµμ°¨ κ²€μ¦μ„ μν–‰ν•λ” ν•¨μ
    - `scoring` : κ²€μ¦μ— μ‚¬μ©ν•  ν‰κ°€ μ§€ν‘ (λ¶„λ¥ λ¨λΈ β†’ accuracy, νκ·€ λ¨λΈ β†’ r2)
    - `cv` : κµμ°¨ κ²€μ¦ ν΄λ“ μλ‚ μ¤ν•„λ¦¬ν„° κ°μ²΄ (κΈ°λ³Έκ°’ : 5) (νκ·€ β†’ `StratifiedKFold`, λ¶„λ¥ β†’ `KFold`)
    - `n_jobs` : κµμ°¨ κ²€μ¦μ„ μν–‰ν•  λ• μ‚¬μ©ν•  CPU μ½”μ–΄ μ (κΈ°λ³Έκ°’ : 1, λ¨λ“  μ½”μ–΄ : -1)
    - `return_train_score` : Trueλ΅ μ§€μ •ν•λ©΄ ν›λ ¨ μ„ΈνΈμ μ μλ„ λ°ν™, κΈ°λ³Έκ°’μ€ False
- GridSearchCV : κµμ°¨ κ²€μ¦μΌλ΅ ν•μ΄νΌνλΌλ―Έν„° νƒμƒ‰μ„ μν–‰. μµμƒμ λ¨λΈμ„ μ°Ύμ€ ν›„ ν›λ ¨ μ„ΈνΈ μ „μ²΄λ¥Ό μ‚¬μ©ν•΄ μµμΆ… λ¨λΈμ„ ν›λ ¨
    - μ²« λ²μ§Έ λ§¤κ°λ³€μλ΅ κ·Έλ¦¬λ“ μ„μΉλ¥Ό μν–‰ν•  λ¨λΈ κ°μ²΄λ¥Ό μ „λ‹¬ν•κ³ , λ‘ λ²μ§Έ λ§¤κ°λ³€μλ΅ νƒμƒ‰ν•  λ¨λΈμ λ§¤κ°λ³€μμ™€ κ°’μ„ μ „λ‹¬ν•λ‹¤.
- RandomizedSearchCV : κµμ°¨ κ²€μ¦μΌλ΅ λλ¤ν• ν•μ΄νΌνλΌλ―Έν„° νƒμƒ‰μ„ μν–‰. μµμƒμ λ¨λΈμ„ μ°Ύμ€ ν›„ ν›λ ¨ μ„ΈνΈ μ „μ²΄λ¥Ό μ‚¬μ©ν•΄ μµμΆ… λ¨λΈμ„ ν›λ ¨.
    - μ²« λ²μ§Έ λ§¤κ°λ³€μλ΅ λλ¤ μ„μΉλ¥Ό μν–‰ν•  λ¨λΈ κ°μ²΄λ¥Ό μ „λ‹¬ν•κ³ , λ‘ λ²μ§Έ λ§¤κ°λ³€μλ΅ νƒμƒ‰ν•  λ¨λΈμ λ§¤κ°λ³€μμ™€ ν™•λ¥  λ¶„ν¬ κ°μ²΄λ¥Ό μ „λ‹¬ν•λ‹¤.